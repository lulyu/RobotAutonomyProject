% Auto-generated by cameraCalibrator app on 15-Feb-2015
%-------------------------------------------------------
filepath = 'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawleft';
pic_num = round(rand([50,1])*3473);
%pic_num = [3;5;1214;1580;2734];
pic_num = num2str(pic_num,'%04i');

% Define images to process
imageFileNames = cell(1,size(pic_num,1));
for i=1:size(pic_num,1)
    imageFileNames{i}= strcat(filepath,pic_num(i,:),'.jpg');
end

% imageFileNames = {'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0032.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0034.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0157.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0159.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0173.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0218.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0238.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0258.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0293.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0306.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0312.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2502.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2543.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2548.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2707.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2709.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0602.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright0610.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2251.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2252.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2258.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2260.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2386.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2387.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2438.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2444.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2507.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2541.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2542.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2546.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2549.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2654.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2657.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2658.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2692.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2695.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2738.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2745.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2772.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2778.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2818.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2820.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2261.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2262.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2361.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2368.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2392.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2399.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2416.jpg',...
%     'D:\Study\Robot Autonomy\Project\P2A\cmu_16662_camera_calibration\rawright2422.jpg',...
%     };

% Detect checkerboards in images
[imagePoints, boardSize, imagesUsed] = detectCheckerboardPoints(imageFileNames);
imageFileNames = imageFileNames(imagesUsed);

% Generate world coordinates of the corners of the squares
squareSize = 1.523000e+01;  % in units of 'cm'
worldPoints = generateCheckerboardPoints(boardSize, squareSize);

% Calibrate the camera
cameraParams = estimateCameraParameters(imagePoints, worldPoints, ...
    'EstimateSkew', false, 'EstimateTangentialDistortion', false, ...
    'NumRadialDistortionCoefficients', 2, 'WorldUnits', 'cm');

% View reprojection errors
h1=figure; showReprojectionErrors(cameraParams, 'BarGraph');

% Visualize pattern locations
h2=figure; showExtrinsics(cameraParams, 'CameraCentric');

% For example, you can use the calibration data to remove effects of lens distortion.
originalImage = imread(imageFileNames{1});
undistortedImage = undistortImage(originalImage, cameraParams);

% See additional examples of how to use the calibration data.  At the prompt type:
% showdemo('MeasuringPlanarObjectsExample')
% showdemo('SparseReconstructionExample')
